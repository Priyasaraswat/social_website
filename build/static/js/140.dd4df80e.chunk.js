"use strict";(self.webpackChunkreact_social=self.webpackChunkreact_social||[]).push([[140],{6140:function(e,s,a){a.r(s),a.d(s,{default:function(){return j}});var t=a(4165),n=a(5861),r=a(885),c=a(2791),i=a(6856),o=a(6452),l=a(4569),p=a.n(l),u=a(184);var d=function(){var e="http://localhost:4000/images/",s=(0,c.useContext)(o.V).user,a=(0,c.useRef)(),l=(0,c.useState)(null),d=(0,r.Z)(l,2),h=d[0],m=d[1],x=function(){var e=(0,n.Z)((0,t.Z)().mark((function e(n){var r,c,i;return(0,t.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n.preventDefault(),r={userId:s._id,desc:a.current.value},!h){e.next=16;break}return c=new FormData,i=Date.now()+h.name,c.append("name",i),c.append("file",h),r.img=i,e.prev=8,e.next=11,p().post("/api/upload",c);case 11:e.next=16;break;case 13:e.prev=13,e.t0=e.catch(8),console.log(e.t0);case 16:return e.prev=16,e.next=19,p().post("/api/posts",r);case 19:window.location.reload(),e.next=25;break;case 22:e.prev=22,e.t1=e.catch(16),console.log(e.t1);case 25:case"end":return e.stop()}}),e,null,[[8,13],[16,22]])})));return function(s){return e.apply(this,arguments)}}();return(0,u.jsxs)("div",{className:"share",children:[(0,u.jsxs)("div",{className:"shareTop",children:[(0,u.jsx)("img",{src:s.profilePhoto?e+s.profilePhoto:e+"noAvatar.png",alt:"",className:"shareimg"}),(0,u.jsx)("input",{placeholder:"What's in your mind "+s.username+"?",ref:a,className:"share-input"})]}),(0,u.jsx)("hr",{className:"shareHr"}),h&&(0,u.jsxs)("div",{className:"share-img-container",children:[(0,u.jsx)("img",{className:" share-img-file",src:URL.createObjectURL(h),alt:""}),(0,u.jsx)(i.lUB,{className:"share-cancel-img-btn",onClick:function(){return m(null)}})]}),(0,u.jsx)("form",{className:"share-bottom",onSubmit:x,children:(0,u.jsxs)("div",{className:"share-options",children:[(0,u.jsxs)("label",{htmlFor:"file",className:"share-option",children:[(0,u.jsx)(i.SnS,{className:"shareIcon mediaicon"}),(0,u.jsx)("span",{className:"shareIconOptionText",children:"Photo or Video"}),(0,u.jsx)("input",{style:{display:"none"},type:"file",id:"file",accept:".png,.jpg,.jpeg",onChange:function(e){return m(e.target.files[0])}})]}),(0,u.jsxs)("div",{className:"share-option",children:[(0,u.jsx)(i.yV_,{className:"shareIcon labelicon"}),(0,u.jsx)("span",{className:"shareIconOptionText",children:"Tag"})]}),(0,u.jsxs)("div",{className:"share-option",children:[(0,u.jsx)(i.$0r,{className:"shareIcon locationicon"}),(0,u.jsx)("span",{className:"shareIconOptionText",children:"Location"})]}),(0,u.jsxs)("div",{className:"share-option",children:[(0,u.jsx)(i.a1m,{className:"shareIcon emojiicon"}),(0,u.jsx)("span",{className:"shareIconOptionText",children:"Feelings"})]}),(0,u.jsx)("button",{className:"share-button",type:"submit",children:"Share"})]})})]})},h=a(4651),m=a(3688),x=a(3504);var f=function(e){var s=e.post,a=(0,c.useState)(s.likes.length),l=(0,r.Z)(a,2),d=l[0],f=l[1],j=(0,c.useState)(!1),v=(0,r.Z)(j,2),N=v[0],g=v[1],k="http://localhost:4000/images/",b=(0,c.useState)({}),w=(0,r.Z)(b,2),Z=w[0],I=w[1],_=(0,c.useContext)(o.V).user,y=(0,c.useState)(!1),C=(0,r.Z)(y,2),S=C[0],D=C[1];(0,c.useEffect)((function(){g(s.likes.includes(_._id))}),[_._id,s.likes]),(0,c.useEffect)((function(){var e=function(){var e=(0,n.Z)((0,t.Z)().mark((function e(){var a;return(0,t.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,p().get("/api/users?userId=".concat(s.userId));case 2:a=e.sent,I(a.data);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();e()}),[s.userId]);var A=function(){try{p().put("/api/posts/"+s._id+"/like",{userId:_._id})}catch(e){}f(N?d-1:d+1),g(!N)};return(0,u.jsxs)("div",{className:"post",children:[(0,u.jsxs)("div",{className:"post-top",children:[(0,u.jsxs)("div",{className:"post-top-left",children:[(0,u.jsx)(x.rU,{to:"/profile/".concat(Z.username),children:(0,u.jsx)("img",{src:Z.profilePhoto?k+Z.profilePhoto:k+"noAvatar.png",alt:"",className:"post-user-img"})}),(0,u.jsx)("span",{className:"post-user-name",children:Z.username}),(0,u.jsxs)("span",{className:"post-time",children:[(0,m.WU)(s.createdAt),"."]})]}),(0,u.jsxs)("div",{className:"post-top-right",children:[(0,u.jsxs)("div",{className:S?"active-icon":"delete-post-icon",onClick:function(){try{p().delete("/api/posts/"+s._id),window.location.reload()}catch(e){console.log(e)}},children:[(0,u.jsx)(i.FH3,{})," Delete the post"]}),(0,u.jsx)(h.D_A,{className:"share-icon",onClick:function(){D(!S)}})]})]}),(0,u.jsxs)("div",{className:"post-center",children:[(0,u.jsx)("span",{className:"post-caption",children:null===s||void 0===s?void 0:s.desc}),(0,u.jsx)("img",{src:k+s.img,alt:"",className:"post-img"})]}),(0,u.jsx)("div",{className:"post-bottom",children:(0,u.jsxs)("div",{className:"post-bottom-left",children:[(0,u.jsx)("img",{src:k+"likes.png",alt:"",className:"post-like",onClick:A}),(0,u.jsx)("img",{src:k+"heart.png",alt:"",className:"post-heart",onClick:A}),(0,u.jsxs)("span",{className:"post-like-text",children:[d," liked it"]})]})})]})};var j=function(e){var s=e.username,a=(0,c.useState)([]),i=(0,r.Z)(a,2),l=i[0],h=i[1],m=(0,c.useContext)(o.V).user;return(0,c.useEffect)((function(){var e=function(){var e=(0,n.Z)((0,t.Z)().mark((function e(){var a;return(0,t.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,!s){e.next=7;break}return e.next=4,p().get("/api/posts/profile/"+s);case 4:e.t0=e.sent,e.next=10;break;case 7:return e.next=9,p().get("/api/posts/timeline/"+m._id);case 9:e.t0=e.sent;case 10:a=e.t0,h(a.data.sort((function(e,s){return new Date(s.createdAt)-new Date(e.createdAt)}))),e.next=17;break;case 14:e.prev=14,e.t1=e.catch(0),console.log(e.t1);case 17:case"end":return e.stop()}}),e,null,[[0,14]])})));return function(){return e.apply(this,arguments)}}();e()}),[s,m._id]),(0,u.jsxs)("div",{className:"centerbar",children:[(!s||s===m.username)&&(0,u.jsx)(d,{}),l.map((function(e){return(0,u.jsx)(f,{post:e},e._id)}))]})}}}]);
//# sourceMappingURL=140.dd4df80e.chunk.js.map