"use strict";(self.webpackChunkreact_social=self.webpackChunkreact_social||[]).push([[264,573],{6608:function(e,n,t){t.d(n,{M:function(){return i},q:function(){return o}});var s=t(4165),r=t(5861),a=t(4569),c=t.n(a),i=function(){var e=(0,r.Z)((0,s.Z)().mark((function e(n,t){var r;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t({type:"LOGIN_START"}),e.prev=1,e.next=4,c().post("/api/auth/login",n);case 4:r=e.sent,t({type:"LOGIN_SUCCESS",payload:r.data}),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),t({type:"LOGIN_FAILURE",payload:e.t0});case 11:case"end":return e.stop()}}),e,null,[[1,8]])})));return function(n,t){return e.apply(this,arguments)}}(),o=function(){var e=(0,r.Z)((0,s.Z)().mark((function e(n){return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n({type:"LOGOUT"});case 1:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}()},5573:function(e,n,t){t.r(n),t.d(n,{default:function(){return h}});var s=t(4165),r=t(5861),a=t(885),c=t(2791),i=t(3504),o=t(6856),l=t(6452),u=t(6608),d=t(4569),p=t.n(d),v=t(184);var h=function(){var e="http://localhost:4000/images/",n=(0,c.useContext)(l.V),t=n.user,d=n.dispatch,h=(0,c.useState)(!1),m=(0,a.Z)(h,2),f=m[0],x=m[1],j=function(){var e=(0,r.Z)((0,s.Z)().mark((function e(){return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,p().delete("/api/users/"+t._id);case 3:console.log("deleted"),e.next=9;break;case 6:e.prev=6,e.t0=e.catch(0),console.log(e.t0);case 9:case"end":return e.stop()}}),e,null,[[0,6]])})));return function(){return e.apply(this,arguments)}}();return(0,v.jsxs)("div",{className:"topbar",children:[(0,v.jsx)("div",{className:"topbar-left",children:(0,v.jsx)(i.rU,{to:"/",children:(0,v.jsxs)("div",{className:"topbar-logo-div",children:[(0,v.jsx)(o.LY4,{className:"topbar-logo-icon"}),(0,v.jsx)("span",{className:"topbar-logo",children:"SOciAL BEinGS"})]})})}),(0,v.jsxs)("div",{className:"topbar-right",children:[(0,v.jsxs)("div",{className:f?"topbarLinks":"topbarLinksmenu",children:[(0,v.jsx)(i.rU,{to:"/",children:(0,v.jsxs)("div",{className:"topbar-menu-icon ",children:[(0,v.jsxs)("span",{className:"topbarLink",children:[" ",(0,v.jsx)(o.bH4,{})]}),(0,v.jsx)("span",{className:"topbarLink-text",children:"Home"})]})}),(0,v.jsx)(i.rU,{to:"/messanger",children:(0,v.jsxs)("div",{className:"topbar-menu-icon ",children:[(0,v.jsxs)("span",{className:"topbarLink",children:[" ",(0,v.jsx)(o.Fmx,{})]}),(0,v.jsx)("span",{className:"topbarLink-text",children:"Message"})]})}),(0,v.jsx)(i.rU,{to:"/showAllUser",children:(0,v.jsxs)("div",{className:"topbar-menu-icon ",children:[(0,v.jsxs)("span",{className:"topbarLink",children:[" ",(0,v.jsx)(o.Mgh,{})]}),(0,v.jsx)("span",{className:"topbarLink-text",children:"Users"})]})}),(0,v.jsx)(i.rU,{to:"/updateuserdata",children:(0,v.jsxs)("div",{className:"topbar-menu-icon ",children:[(0,v.jsx)("span",{className:"topbarLink",children:(0,v.jsx)(o.ZO5,{})}),(0,v.jsx)("span",{className:"topbarLink-text",children:"Update"})]})}),(0,v.jsxs)("div",{className:"topbar-menu-icon ",onClick:function(){(0,u.q)(d),j()},children:[(0,v.jsx)("span",{className:"topbarLink",children:(0,v.jsx)(o.lE7,{})}),(0,v.jsx)("span",{className:"topbarLink-text",children:"Log Out"})]}),(0,v.jsx)(i.rU,{to:"/profile/".concat(t.username),children:(0,v.jsxs)("div",{className:"topbar-menu-icon  ",children:[(0,v.jsx)("img",{src:t.profilePhoto?e+t.profilePhoto:e+"noAvatar.png",alt:"",className:"topbar-dp-img "}),(0,v.jsx)("span",{className:"topbarLink-text topbar-profile-icon",children:"Profile"})]})})]}),(0,v.jsx)("div",{className:"menu-hamburger-icon",onClick:function(){x(!f)},children:f?(0,v.jsx)(o.lUB,{}):(0,v.jsx)(o.xXU,{})})]})]})}},7264:function(e,n,t){t.r(n),t.d(n,{default:function(){return j}});var s=t(4165),r=t(5861),a=t(2982),c=t(885),i=t(2791),o=t(4569),l=t.n(o),u=t(184);var d=function(e){var n=e.onlineUsers,t=e.currentId,a=e.setCurrentChat,o=(0,i.useState)([]),d=(0,c.Z)(o,2),p=d[0],v=d[1],h=(0,i.useState)([]),m=(0,c.Z)(h,2),f=m[0],x=m[1],j="http://localhost:4000/images/";(0,i.useEffect)((function(){var e=function(){var e=(0,r.Z)((0,s.Z)().mark((function e(){var n;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,l().get("/api/users/friends/"+t);case 2:n=e.sent,v(n.data);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();e()}),[t]),(0,i.useEffect)((function(){x(p.filter((function(e){return null===n||void 0===n?void 0:n.includes(null===e||void 0===e?void 0:e._id)})))}),[p,n]);var g=function(){var e=(0,r.Z)((0,s.Z)().mark((function e(n){var r;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,l().get("/api/conversation/find/".concat(t,"/").concat(null===n||void 0===n?void 0:n._id));case 3:r=e.sent,a(r.data),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.log(e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(n){return e.apply(this,arguments)}}();return(0,u.jsx)("div",{className:"chat-online",children:f.map((function(e){return(0,u.jsxs)("div",{className:"chat-online-friend",onClick:function(){return g(e)},children:[(0,u.jsxs)("div",{className:"chat-online-img-contanier",children:[(0,u.jsx)("img",{src:null!==e&&void 0!==e&&e.profilePhoto?j+(null===e||void 0===e?void 0:e.profilePhoto):j+"noAvatar.png",alt:"",className:"chat-online-img"}),(0,u.jsx)("span",{className:"chat-online-badge"})]}),(0,u.jsx)("div",{className:"chat-online-name",children:null===e||void 0===e?void 0:e.username})]})}))})};var p=function(e){var n=e.conversation,t=e.currentUser,a=(0,i.useState)(null),o=(0,c.Z)(a,2),d=o[0],p=o[1],v="http://localhost:4000/images/";return(0,i.useEffect)((function(){var e=n.members.find((function(e){return e!==t._id})),a=function(){var n=(0,r.Z)((0,s.Z)().mark((function n(){var t;return(0,s.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,l().get("/api/users?userId="+e);case 3:t=n.sent,p(t.data),n.next=10;break;case 7:n.prev=7,n.t0=n.catch(0),console.log(n.t0);case 10:case"end":return n.stop()}}),n,null,[[0,7]])})));return function(){return n.apply(this,arguments)}}();a()}),[t,n]),(0,u.jsxs)("div",{className:"conversations",children:[(0,u.jsx)("img",{className:"conversations-img",src:null!==d&&void 0!==d&&d.profilePhoto?v+(null===d||void 0===d?void 0:d.profilePhoto):v+"noAvatar.png",alt:""}),(0,u.jsx)("span",{className:"conversations-name ",children:null===d||void 0===d?void 0:d.username})]})},v=t(3688);var h=function(e){var n=e.message,t=e.own;return(0,u.jsxs)("div",{className:t?"message own":"message ",children:[(0,u.jsxs)("div",{className:"message-top",children:[(0,u.jsx)("img",{src:"https://images.pexels.com/photos/38289/portrait-photography-profile-face-one-38289.jpeg?auto=compress&cs=tinysrgb&w=1260&h=750&dpr=1",alt:"",className:"message-top-img"}),(0,u.jsx)("p",{className:"message-top-img-text",children:null===n||void 0===n?void 0:n.text})]}),(0,u.jsx)("div",{className:"message-bottom",children:(0,v.WU)(null===n||void 0===n?void 0:n.createdAt)})]})},m=t(5573),f=t(6452),x=t(4339);var j=function(){var e=(0,i.useState)([]),n=(0,c.Z)(e,2),t=n[0],o=n[1],v=(0,i.useState)(null),j=(0,c.Z)(v,2),g=j[0],N=j[1],b=(0,i.useState)([]),Z=(0,c.Z)(b,2),k=Z[0],_=Z[1],w=(0,i.useState)(""),S=(0,c.Z)(w,2),L=S[0],U=S[1],C=(0,i.useState)(null),E=(0,c.Z)(C,2),y=E[0],O=E[1],I=(0,i.useState)([]),P=(0,c.Z)(I,2),A=P[0],T=P[1],R=(0,i.useRef)(),D=(0,i.useRef)(),F=(0,i.useContext)(f.V).user,G={NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_PUBLIC_FOLDER:"http://localhost:4000/images/"}.PORT;(0,i.useEffect)((function(){D.current=(0,x.io)(G),D.current.on("getMessage",(function(e){O({sender:e.senderId,text:e.text,createdAt:Date.now()})}))}),[]),(0,i.useEffect)((function(){y&&(null===g||void 0===g?void 0:g.members.includes(y.sender))&&_((function(e){return[].concat((0,a.Z)(e),[y])}))}),[y,g]),(0,i.useEffect)((function(){D.current.emit("addUser",F._id),D.current.on("getUser",(function(e){T(F.following.filter((function(n){return e.some((function(e){return(null===e||void 0===e?void 0:e.userId)===n}))})))}))}),[F]),(0,i.useEffect)((function(){var e=function(){var e=(0,r.Z)((0,s.Z)().mark((function e(){var n;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,l().get("/api/conversation/"+F._id);case 3:n=e.sent,o(n.data),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.log(e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(){return e.apply(this,arguments)}}();e()}),[F._id]),(0,i.useEffect)((function(){var e=function(){var e=(0,r.Z)((0,s.Z)().mark((function e(){var n;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,l().get("/api/message/"+(null===g||void 0===g?void 0:g._id));case 3:n=e.sent,_(n.data),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.log(e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(){return e.apply(this,arguments)}}();e()}),[g]);var H=function(){var e=(0,r.Z)((0,s.Z)().mark((function e(n){var t,r,c;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.preventDefault(),t={sender:F._id,text:L,conversationId:g._id},r=g.members.find((function(e){return e!==F._id})),D.current.emit("sendMessage",{senderId:F._id,receiverId:r,text:L}),e.prev=4,e.next=7,l().post("/api/message",t);case 7:c=e.sent,_([].concat((0,a.Z)(k),[c.data])),U(""),e.next=15;break;case 12:e.prev=12,e.t0=e.catch(4),console.log(e.t0);case 15:case"end":return e.stop()}}),e,null,[[4,12]])})));return function(n){return e.apply(this,arguments)}}();return(0,i.useEffect)((function(){var e;null===(e=R.current)||void 0===e||e.scrollIntoView({behaviour:"smooth"})}),[k]),(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)(m.default,{}),(0,u.jsxs)("div",{className:"messanger",children:[(0,u.jsx)("div",{className:"chat-menu",children:(0,u.jsxs)("div",{className:"chat-menu-wrapper",children:[(0,u.jsx)("h4",{className:"messanger-heading",children:"Connect to people\ud83e\udd1c\ud83e\udd1b"}),t.map((function(e){return(0,u.jsx)("div",{onClick:function(){return N(e)},children:(0,u.jsx)(p,{conversation:e,currentUser:F},e._id)})}))]})}),(0,u.jsx)("div",{className:"chat-box",children:(0,u.jsx)("div",{className:"chat-box-wrapper",children:g?(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)("div",{className:"chat-box-top",children:k.map((function(e){return(0,u.jsx)("div",{ref:R,children:(0,u.jsx)(h,{message:e,own:(null===e||void 0===e?void 0:e.sender)===F._id},e._id)})}))}),(0,u.jsxs)("div",{className:"chat-box-bottom",children:[(0,u.jsx)("textarea",{className:"chat-box-bottom-msg",placeholder:"write something...",onChange:function(e){U(e.target.value)},value:L}),(0,u.jsx)("button",{className:"chat-box-send",onClick:H,children:"Send"})]})]}):(0,u.jsx)("span",{className:"chat-box-no-chat",children:"Open a conversation to start the chat \ud83d\udc40"})})}),(0,u.jsx)("div",{className:"chat-online",children:(0,u.jsx)("div",{className:"chat-online-wrapper",children:(0,u.jsx)(d,{onlineUsers:A,currentId:null===F||void 0===F?void 0:F._id,setCurrentChat:N})})})]})]})}}}]);
//# sourceMappingURL=264.1a01ccd8.chunk.js.map